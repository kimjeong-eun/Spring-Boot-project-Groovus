<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      layout:decorate="~{layout/basic.html}">
<head>
    <meta charset="UTF-8">
    <title>드라이브</title>

    <th:block layout:fragment="css">

        <style>

            #logoImg{
                background-color: #2de3f1;
            }

        </style>

    </th:block>
</head>

<th:block layout:fragment="content">

<!--    <div class="row">-->

<!--        <div class="col-lg-6 col-md-12">-->
<!--            <div class="card">-->
<!--                <div class="card-body">-->
<!--                    <h1>드라이브</h1>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->


    <span>
                <a th:href="@{/drive/register}">
                    <button type="button" class="btn btn-outline-primary">파일 등록
                    </button>
                </a>
            </span>
    </h1>


<!--    다운로드 버튼 <button type="button" class="btn btn-success" onclick="downloadSelectedFiles()">다운로드</button>-->

    <form action="/drive/drive" method="get" id="searchForm">
        <input type="hidden" name="page" value="1">
    </form>

    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col"></th>
            <th scope="col">제목</th>

            <th scope="col">수정일</th>
        </tr>
        </thead>
        <tbody>

        <tr th:each="dto : ${result.dtoList}" >
<!--            <th scope="row">-->
<!--                <a th:href="@{/drive/read(bno = ${dto.bno}, page= ${result.page})}">-->
<!--                    [[${dto.bno}]]-->
<!--                </a>-->
<!--            </th>-->
            <td> <!-- 제목이 표시되는 열에 체크박스 추가 -->
                <input type="checkbox" name="selectedItems" th:value="${dto.bno}"/>
            </td>

            <td><img th:if="${dto.imageDTOList.size() > 0 && dto.imageDTOList[0].path != null }"
                     th:src="|/display?fileName=${dto.imageDTOList[0].getThumbnailURL()}|" >
                <a th:href="@{/drive/read(bno = ${dto.bno}, page= ${result.page})}">[[${dto.title}]]</td>

            <td>[[${#temporals.format(dto.modDate, 'yyyy/MM/dd')}]]</td>
        </tr>

        </tbody>
    </table>

    <ul class="pagination h-100 justify-content-center align-items-center">

        <li class="page-item " th:if="${result.prev}">
            <a class="page-link" th:href="@{/drive/drive(page= ${result.start -1})}" tabindex="-1">Previous</a>
        </li>

        <li th:class=" 'page-item ' + ${result.page == page?'active':''} " th:each="page: ${result.pageList}">
            <a class="page-link" th:href="@{/drive/drive(page = ${page})}">
                [[${page}]]
            </a>
        </li>

        <li class="page-item" th:if="${result.next}">
            <a class="page-link" th:href="@{/drive/drive(page= ${result.end + 1} )}">Next</a>
        </li>
    </ul>


    <script th:inline="javascript">

    </script>

<!--   다운로드 <script th:inline="javascript">-->
<!--        function downloadSelectedFiles() {-->
<!--            // 체크된 항목들을 가져옵니다.-->
<!--            var selectedItems = document.querySelectorAll('input[name="selectedItems"]:checked');-->

<!--            // 체크된 항목들의 bno 값을 가져와서 배열로 저장합니다.-->
<!--            var selectedBnos = [];-->
<!--            selectedItems.forEach(function(item) {-->
<!--                selectedBnos.push(item.value);-->
<!--            });-->

<!--            // 체크된 항목이 없는 경우에는 알림을 표시합니다.-->
<!--            if (selectedBnos.length === 0) {-->
<!--                alert('선택된 파일이 없습니다.');-->
<!--                return;-->
<!--            }-->

<!--            // 서버로 선택된 파일들의 bno 값을 전달하여 다운로드 요청을 보냅니다.-->
<!--            window.location.href = '/drive/download?bno=' + selectedBnos.join(',');-->
<!--        }-->
<!--    </script> -->

</th:block>

</html>